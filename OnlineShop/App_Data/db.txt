---- DATABASE : ONLINESHOP _ BTLON CNWEB ---
---- MTAZERO  : BUI XUAN THUY ----
GO
	USE MASTER 
GO
	DROP DATABASE ONLINE_SHOP
GO
	CREATE DATABASE ONLINE_SHOP
GO
	USE ONLINE_SHOP
GO
	CREATE TABLE KICHTHUOC(
		ID INT IDENTITY PRIMARY KEY,
		TEN NVARCHAR(MAX),
		LOAI INT --- 0: GIAY, 1: QUAN AO, 2: THAT LUNG, 3: TUI XACH
	)
GO
	CREATE TABLE NGUOIDUNG(
		ID INT IDENTITY PRIMARY KEY,
		TEN NVARCHAR(MAX),
		EMAIL NVARCHAR(MAX),
		PASSWORD NVARCHAR(MAX), -- MẬT KHẨU ĐÃ ĐƯỢC MÃ HÓA MD5
		QUYEN INT, -- 1: ADMIN, 2: NGUOI  DUNG
		ANHDAIDIEN NVARCHAR(MAX) -- PATH
	)
GO
	CREATE TABLE SANPHAM(
		ID INT IDENTITY PRIMARY KEY,
		TEN NVARCHAR(MAX),
		GIASANPHAM FLOAT,
		KHUYENMAI FLOAT, -- [0..99]
		MOTA NVARCHAR(MAX),
		THONGTIN NVARCHAR(MAX),
		LOAISP INT, -- 0: GIAY, 1: QUAN AO, 2: THAT LUNG, 3: TUI XACH
		DOITUONG INT, -- 0: NAM, 1: NỮ
		TRANGTHAI INT, -- 0: CÒN HÀNG, 1: HẾT HÀNG
	)
GO
	CREATE TABLE DANHGIA(
		ID INT IDENTITY PRIMARY KEY,
		SANPHAMID INT,
			FOREIGN KEY (SANPHAMID) REFERENCES SANPHAM(ID),
		NGUOIDUNGID INT,
			FOREIGN KEY (NGUOIDUNGID) REFERENCES NGUOIDUNG(ID),
		DANHGIA INT, --- 1 -> 5 TUONG DUONG 1 DEN 5 SAO
		TRANGTHAI INT -- 0 : NGUOI DO CHUA TUNG DANH GIA, 1: NGUOI DO DA DANH GIA
	)
GO
	CREATE TABLE ANHSP(
		ID INT IDENTITY PRIMARY KEY,
		SANPHAMID INT,
			FOREIGN KEY (SANPHAMID) REFERENCES SANPHAM(ID),
		SRC NVARCHAR(MAX)
	)
GO
	CREATE TABLE COMMENT(
		ID INT IDENTITY PRIMARY KEY,
		NGUOIDUNGID INT,
			FOREIGN KEY (NGUOIDUNGID) REFERENCES NGUOIDUNG(ID),
		SANPHAMID INT,
			FOREIGN KEY (SANPHAMID) REFERENCES SANPHAM(ID),
		THOIGIAN DATETIME,
		NOIDUNG NVARCHAR(MAX)
	)
GO
	CREATE TABLE GIOHANG(
		ID INT IDENTITY PRIMARY KEY,
		NGUOIDUNGID INT,
			FOREIGN KEY (NGUOIDUNGID) REFERENCES NGUOIDUNG(ID),
		NGAY DATETIME,
		DIACHIGIAOHANG NVARCHAR(MAX),
		TRANGTHAI INT, -- 0: CHƯA ĐẶT MUA, 1: ĐÃ ĐẶT MUA VÀ CHƯA GIAO HÀNG, 2: ĐÃ GIAO HÀNG
		TONGTIEN FLOAT,
		NGUOIXACNHANID INT,
			FOREIGN KEY (NGUOIXACNHANID) REFERENCES NGUOIDUNG(ID)
	)
GO
	CREATE TABLE CHITIETGIOHANG(
		ID INT IDENTITY PRIMARY KEY,
		SANPHAMID INT,
			FOREIGN KEY (SANPHAMID) REFERENCES SANPHAM(ID),
		SOLUONG INT,
		DONGIA FLOAT,
		THANHTIEN FLOAT,
		KICHTHUOCID INT,
			FOREIGN KEY (KICHTHUOCID) REFERENCES KICHTHUOC(ID)
	)
GO
	CREATE TABLE PHANHOI(
		--- KHÁCH HÀNG GỬI THƯ PHẢN ÁNH VỚI ADMIN
		ID INT IDENTITY PRIMARY KEY,
		TEN NVARCHAR(MAX),
		EMAIL NVARCHAR(MAX),
		TIEUDE NVARCHAR(MAX),
		NOIDUNG NVARCHAR(MAX),
		NGAY DATETIME,
		TRANGTHAI INT -- 0: CHƯA ĐƯỢC ĐỌC, 1: ĐÃ ĐƯỢC ĐỌC
	)
GO
--- ADD DỮ LIỆU MẪU ---
	INSERT INTO NGUOIDUNG(TEN, EMAIL, PASSWORD, QUYEN) VALUES(N'MTAZero', N'buithuy3996@gmail.com', N'1', 1)
GO